# 単体テスト QA 基準

## 用語定義
* 品質過剰: 実用的な価値が低いにもかかわらず、テストが過度に詳細であること
* 80/24ルール: 1行80文字以内、1関数24行以内のコーディング規約

## 目標コードカバレッジ
* [ ] ステートメントカバレッジ: 80% 以上
* [ ] ブランチカバレッジ: 90% 以上
* [ ] 関数カバレッジ: 100%

## 実施すべきテスト
以下テストを構築することで、リグレッション検知を可能とする

### 1. 境界値テスト - Equivalence Class Testing
* [ ] 各パラメータの最小値、最小値-1、最小値+1
* [ ] 各パラメータの最大値、最大値-1、最大値+1
* [ ] ゼロ、負の値、正の値の境界
* [ ] 空文字列、null、undefined、NaN、Optional等の特殊値

### 2. 同値分割テスト - Boundary Value Testing
* [ ] 有効同値グループと無効同値グループを特定
* [ ] 各グループの代表値を選択
* [ ] 代表値の選択理由を説明するコメントを追加
* [ ] テストツールのイテレーター等を使用して効率的にテストを記述
  * ex. ruby の `Object.each`
  * ex. vitest の `test.each`: https://vitest.dev/api/#test-each

### 3. 機能完全性テスト - Functional Completeness Testing
* [ ] 上記テスト以外の正常系, 異常系機能テストケースを追加
  * MECE な分け方で分類した時、漏れがないこと
* [ ] エッジケースの網羅確認
  * **エッジケーステストは、過剰品質担保を避ける** (事細かく作りすぎたテストはむしろコストを増やす)

## その他: テスト記述基準
* [ ] ライブラリーロード → モック(mock/spy) → 共通事前定義(before/after) → 正常系 → 異常系 の順に記述する
* [ ] コメント には Why(なぜそれが必要なのか) を記述する
  * 関数名や変数名を言い換えただけ、自明な記述はしない
* [ ] 事前定義(before/after/共有変数)をDRYにすること
* [ ] **80/24 ルールを可能な限り遵守する**
  * 特に、24行を超える場合はテストケース分割を行う
* [ ] lint により記述シンプルさが失われる場合、ignore を設ける
* [ ] テストケース一回の実行時間は 1,000ms 以内にする
  * 代案構築が困難な場合「テストの主題だけは記述し、SKIP 理由記述」とする

## 除外すべきテスト
* 多量データを想定した負荷テスト
* 長時間稼働テスト
* セキュリティテスト
* 外部連携テスト
  * テストにおいては、モックもしくはspyに止める
